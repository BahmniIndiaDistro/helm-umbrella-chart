grafana:
  ingress:
    enabled: true
    ingressClassName: nginx
    hosts:
      - monitoring-lite.mybahmni.in
  defaultDashboardsTimezone: browser
  envFromSecret: kube-prometheus-stack-grafana
  adminPassword: $__env{GF_ADMIN_PASSWORD}
  grafana.ini:
    server:
      root_url: https://monitoring-lite.mybahmni.in
    auth.github:
      enabled: true
      allow_sign_up: true
      scopes: user:email,read:org
      client_id: $__env{GF_AUTH_GITHUB_CLIENT_ID}
      client_secret: $__env{GF_AUTH_GITHUB_CLIENT_SECRET}
      auth_url: https://github.com/login/oauth/authorize
      token_url: https://github.com/login/oauth/access_token
      api_url: https://api.github.com/user
      allowed_organizations: Bahmni BahmniIndiaDistro IPLit
    users:
      viewers_can_edit: true
  additionalDataSources:
    - name: Loki
      type: loki
      access: proxy
      url: http://loki:3100
      editable: true
      isDefault: false

  nodeSelector:
    eks.amazonaws.com/nodegroup: nonprod

alertmanager:
  alertmanagerSpec:
    nodeSelector:
      eks.amazonaws.com/nodegroup: nonprod

prometheusOperator:
  nodeSelector:
    eks.amazonaws.com/nodegroup: nonprod
  admissionWebhooks:
    patch:
      nodeSelector:
        eks.amazonaws.com/nodegroup: nonprod

prometheus:
  prometheusSpec:
    retention: 2d
    retentionSize: 8GB
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: bahmni-efs-sc
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 10Gi
    nodeSelector:
      eks.amazonaws.com/nodegroup: nonprod
    additionalScrapeConfigs:
      - job_name: "java"
        metrics_path: "/metrics"
        static_configs:
          - targets: ["openmrs.performance.svc.cluster.local:8280"]
